<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>mecheng: signals::realtime_filter Type Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">mecheng
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   <div id="projectbrief">A library providing common mechanical engineering related calculations.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('structsignals_1_1realtime__filter.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="structsignals_1_1realtime__filter-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">signals::realtime_filter Type Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Computes an array of frequency values corresponding to a discrete Fourier transform of an array.  
 <a href="structsignals_1_1realtime__filter.html#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for signals::realtime_filter:</div>
<div class="dyncontent">
 <div class="center">
  <img src="structsignals_1_1realtime__filter.png" usemap="#signals::realtime_5Ffilter_map" alt=""/>
  <map id="signals::realtime_5Ffilter_map" name="signals::realtime_5Ffilter_map">
<area href="structsignals_1_1fir__filter.html" title="Defines an FIR digital filter. " alt="signals::fir_filter" shape="rect" coords="0,56,133,80"/>
<area href="structsignals_1_1iir__filter.html" title="Defines an IIR digital filter. " alt="signals::iir_filter" shape="rect" coords="143,56,276,80"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a99d1e925ce2595cdb1d7cac0bef44407"><td class="memItemLeft" align="right" valign="top"><a id="a99d1e925ce2595cdb1d7cac0bef44407"></a>
generic, public&#160;</td><td class="memItemRight" valign="bottom"><b>apply</b> =&gt; <a class="el" href="structsignals_1_1realtime__filter.html#a0c8175bacfc97ca0e18c343ce81bcdf9">apply_scalar</a>, apply_array</td></tr>
<tr class="separator:a99d1e925ce2595cdb1d7cac0bef44407"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a0c8175bacfc97ca0e18c343ce81bcdf9"><td class="memItemLeft" align="right" valign="top"><a id="a0c8175bacfc97ca0e18c343ce81bcdf9"></a>
procedure(<a class="el" href="interfacesignals_1_1apply__filter.html">apply_filter</a>), deferred&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsignals_1_1realtime__filter.html#a0c8175bacfc97ca0e18c343ce81bcdf9">apply_scalar</a></td></tr>
<tr class="memdesc:a0c8175bacfc97ca0e18c343ce81bcdf9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies a real-time digital filter. <br /></td></tr>
<tr class="separator:a0c8175bacfc97ca0e18c343ce81bcdf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bdac69916d591e1c215610c54fa693d"><td class="memItemLeft" align="right" valign="top"><a id="a6bdac69916d591e1c215610c54fa693d"></a>
procedure(<a class="el" href="interfacesignals_1_1apply__filter__array.html">apply_filter_array</a>), deferred&#160;</td><td class="memItemRight" valign="bottom"><b>apply_array</b></td></tr>
<tr class="separator:a6bdac69916d591e1c215610c54fa693d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Computes an array of frequency values corresponding to a discrete Fourier transform of an array. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rate</td><td>The rate at which the data was sampled. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">npts</td><td>The number of sampled data points. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An M-element array containing the frequency values. If <code>npts</code> is even, M = <code>npts</code> / 2 + 1; else, M = (<code>npts</code> + 1) / 2. Computes the magnitude of the discrete harmonics of a signal.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>The N-element array containing the signal data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">winfun</td><td>The window function to apply. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">winsize</td><td>The window size. It is recommended that this value be an integer power of two, even if the size of <code>x</code> is not. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The magnitude of the each harmonic component of <code>x</code>. Computes the magnitude of the discrete harmonics of a signal.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>The N-element array containing the signal data. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The magnitude of the each harmonic component of <code>x</code>. Applies a low-pass filter to a time-series data set.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x</td><td>On input, the time-series data to filter. On output, the filtered data set. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fs</td><td>The frequency at which <code>x</code> was sampled, in Hz. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cutoff</td><td>The filter cutoff frequency, in Hz. Notice, a discrete Fourier transform operation is used in the filtering process. As such, the frequency resolution of the discrete transform is <code>fs</code> / n, where n is the length of <code>x</code>. Applies a high-pass filter to a time-series data set.</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x</td><td>On input, the time-series data to filter. On output, the filtered data set. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fs</td><td>The frequency at which <code>x</code> was sampled, in Hz. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cutoff</td><td>The filter cutoff frequency, in Hz. Notice, a discrete Fourier transform operation is used in the filtering process. As such, the frequency resolution of the discrete transform is <code>fs</code> / n, where n is the length of <code>x</code>. Applies a band-pass filter to a time-series data set.</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x</td><td>On input, the time-series data to filter. On output, the filtered data set. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fs</td><td>The frequency at which <code>x</code> was sampled, in Hz. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f1</td><td>The lower cutoff frequency, in Hz. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f2</td><td>The upper cutoff frequency, in Hz.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Remarks</dt><dd>Notice, a discrete Fourier transform operation is used in the filtering process. As such, the frequency resolution of the discrete transform is <code>fs</code> / n, where n is the length of <code>x</code>. Applies a band-stop filter to a time-series data set.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x</td><td>On input, the time-series data to filter. On output, the filtered data set. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fs</td><td>The frequency at which <code>x</code> was sampled, in Hz. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f1</td><td>The lower cutoff frequency, in Hz. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f2</td><td>The upper cutoff frequency, in Hz.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Remarks</dt><dd>Notice, a discrete Fourier transform operation is used in the filtering process. As such, the frequency resolution of the discrete transform is <code>fs</code> / n, where n is the length of <code>x</code>. Applies an averaging filter to a data set.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x</td><td>On input, the signal to filter. On output, the filtered signal. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">npts</td><td>The number of points to include in the moving average. This value must be at least 2, but not exceed the length of <code>x</code>. Computes the Fourier transform of a data set.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>The data set whose transform is to be computed. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The complex-valued Fourier transform of <code>x</code>. Computes the inverse Fourier transform of a complex-valued data set.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>The data set whose transform is to be computed. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The complex-valued Fourier transform of <code>x</code>. Computes the Fourier transform of a real-valued data set, and returns only the positive half of the transform.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x</td><td>The data set whose transform is to be computed. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The complex-valued positive half of the Fourier transform of <code>x</code>. Computes the inverse Fourier transform for a real-valued data set.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>The data set whose transform is to be computed. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The real-valued results of the transform of <code>x</code>. Defines a Bartlett window.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">bin</td><td>The index or bin number (0 &lt;= <code>bin</code> &lt;= <code>winsize</code>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">winsize</td><td>The window size. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The window function value. Defines a Welch window.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">bin</td><td>The index or bin number (0 &lt;= <code>bin</code> &lt;= <code>winsize</code>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">winsize</td><td>The window size. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The window function value. Defines a Hann window.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">bin</td><td>The index or bin number (0 &lt;= <code>bin</code> &lt;= <code>winsize</code>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">winsize</td><td>The window size. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The window function value. Defines a Hamming window.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">bin</td><td>The index or bin number (0 &lt;= <code>bin</code> &lt;= <code>winsize</code>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">winsize</td><td>The window size. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The window function value. Defines a Blackman window.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">bin</td><td>The index or bin number (0 &lt;= <code>bin</code> &lt;= <code>winsize</code>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">winsize</td><td>The window size. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The window function value. Resamples a discrete data set by the specified factor.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>The data set to resample. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fs</td><td>The frequency at which the original data was sampled. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">factor</td><td>An integer factor defining a factor of how much to increase the sample rate <code>fs</code>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The resampled data set. Resamples a discrete data set by the specified factor.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>The data set to resample. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fs</td><td>The frequency at which the original data was sampled. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">factor</td><td>An integer factor defining a factor of how much to decrease the sample rate <code>fs</code>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The resampled data set. Removes any mean (DC) level offset from a signal.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x</td><td>On input, the signal on which to operate. On output, the modified signal. Tests to see if a value is an integer power of two.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>The value to test. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns true if <code>n</code> is a power of two; else, false. Computes the next higher integer power of two.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>The value. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The next integer power of two higher than <code>n</code>. Computes the next lower integer power of two.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>The value. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The previous integer power of two lower than <code>n</code>. Splits the array into equally sized buffers.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>The array to split. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">npts</td><td>The number of points to place in each buffer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An NPTS-by-NBUFFER matrix containing the buffered data.</dd></dl>
<dl class="section user"><dt>Remarks</dt><dd>To accomodate the splitting of the data into the appropriate sized buffers, zeros may be added to the first and last buffers to appropriately fill each buffer. Also notice, data may be overlapped if such an arrangement makes for a better fit within the buffers. Computes the derivative of a data set by utilizing its Fourier transform. Notice, this routine does expect the signal is periodic at it's boundaries. For nonperiodic signals this routine will give erroneous results. Additionally, it is assumed that the data is sampled over equal intervals.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>The lower limit of the sample region. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>The upper limit of the sample region. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>An N-element array containing the signal. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An N-element array containing the derivative of <code>y</code> with respect to the independent variable bounded by <code>a</code> and <code>b</code>.</dd></dl>
<dl class="section user"><dt>Example</dt><dd>The following example illustrates how to compute the first and second derivatives of a periodic signal. <div class="fragment"><div class="line"><span class="keyword">program</span> example</div><div class="line">    <span class="keywordtype">use </span>iso_fortran_env</div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespacefplot__core.html">fplot_core</a></div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespacesignals.html">signals</a></div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespaceconstants.html">constants</a></div><div class="line">    <span class="keywordtype">implicit none</span></div><div class="line"></div><div class="line">    <span class="comment">! Parameters</span></div><div class="line">    <span class="keywordtype">integer(int32)</span>, <span class="keywordtype">parameter</span> :: n = 2048</div><div class="line">    <span class="keywordtype">real(real64)</span>, <span class="keywordtype">parameter</span> :: a = 0.0d0</div><div class="line">    <span class="keywordtype">real(real64)</span>, <span class="keywordtype">parameter</span> :: b = 4.0d0 * pi</div><div class="line"></div><div class="line">    <span class="comment">! Local Variables</span></div><div class="line">    <span class="keywordtype">integer(int32)</span> :: i</div><div class="line">    <span class="keywordtype">real(real64)</span> :: x(n), y(n), dydx(n), ans(n), d2ydx2(n), dx</div><div class="line">    <span class="keywordtype">type</span>(plot_2d) :: plt</div><div class="line">    <span class="keywordtype">type</span>(plot_data_2d) :: d1, d2, d3</div><div class="line">    <span class="keywordtype">class</span>(legend), <span class="keywordtype">pointer</span> :: lgnd</div><div class="line"></div><div class="line">    <span class="comment">! Initialization</span></div><div class="line">    dx = (b - a) / n</div><div class="line">    <span class="keywordflow">do</span> i = 1, n</div><div class="line">        x(i) = a + dx * (i - 1.0d0)</div><div class="line"><span class="keywordflow">    end do</span></div><div class="line">    y = sin(x)</div><div class="line">    ans = cos(x)</div><div class="line">    <span class="keyword">call </span>plt%initialize()</div><div class="line">    <span class="keyword">call </span>plt%set_font_size(14)</div><div class="line"></div><div class="line">    lgnd =&gt; plt%get_legend()</div><div class="line">    <span class="keyword">call </span>lgnd%set_is_visible(.true.)</div><div class="line">    <span class="keyword">call </span>lgnd%set_draw_inside_axes(.false.)</div><div class="line">    <span class="keyword">call </span>lgnd%set_horizontal_position(legend_center)</div><div class="line">    <span class="keyword">call </span>lgnd%set_vertical_position(legend_bottom)</div><div class="line">    <span class="keyword">call </span>lgnd%set_draw_border(.false.)</div><div class="line"></div><div class="line">    <span class="comment">! Compute the derivatives</span></div><div class="line">    dydx = <a class="code" href="interfacesignals_1_1fourier__diff.html">fourier_diff</a>(a, b, y)</div><div class="line">    d2ydx2 = <a class="code" href="interfacesignals_1_1fourier__diff2.html">fourier_diff2</a>(a, b, y)</div><div class="line"></div><div class="line">    <span class="comment">! Plot the results</span></div><div class="line">    <span class="keyword">call </span>d1%set_name(<span class="stringliteral">&quot;Fourier&quot;</span>)</div><div class="line">    <span class="keyword">call </span>d1%set_line_width(2.0)</div><div class="line">    <span class="keyword">call </span>d1%define_data(x, dydx)</div><div class="line"></div><div class="line">    <span class="keyword">call </span>d2%set_name(<span class="stringliteral">&quot;Analytic&quot;</span>)</div><div class="line">    <span class="keyword">call </span>d2%set_line_style(line_dashed)</div><div class="line">    <span class="keyword">call </span>d2%set_line_width(3.0)</div><div class="line">    <span class="keyword">call </span>d2%set_line_color(clr_red)</div><div class="line">    <span class="keyword">call </span>d2%define_data(x, ans)</div><div class="line"></div><div class="line">    <span class="keyword">call </span>d3%set_name(<span class="stringliteral">&quot;2nd Derivative&quot;</span>)</div><div class="line">    <span class="keyword">call </span>d3%set_line_style(line_dash_dotted)</div><div class="line">    <span class="keyword">call </span>d3%set_line_width(2.0)</div><div class="line">    <span class="keyword">call </span>d3%set_line_color(clr_green)</div><div class="line">    <span class="keyword">call </span>d3%define_data(x, d2ydx2)</div><div class="line"></div><div class="line">    <span class="keyword">call </span>plt%push(d1)</div><div class="line">    <span class="keyword">call </span>plt%push(d2)</div><div class="line">    <span class="keyword">call </span>plt%push(d3)</div><div class="line">    <span class="keyword">call </span>plt%draw()</div><div class="line"><span class="keyword">end program</span></div></div><!-- fragment --> The above program produces the following output. <div class="image">
<img src="fourier_diff_example.png" alt="fourier_diff_example.png"/>
<div class="caption">
Computes the derivative of a data set by utilizing its Fourier</div></div>
 transform. Notice, this routine does expect the signal is periodic at it's boundaries. For nonperiodic signals this routine will give erroneous results. Additionally, it is assumed that the data is sampled over equal intervals.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>An N-element array containing the values of the independent variable at which the signal was sampled. It is assumed that the signal is sampled at equal increments. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>An N-element array containing the signal. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An N-element array containing the derivative of <code>y</code> with respect to the independent variable bounded by <code>a</code> and <code>b</code>.</dd></dl>
<dl class="section user"><dt>Example</dt><dd>The following example illustrates how to compute the first and second derivatives of a periodic signal. <div class="fragment"><div class="line"><span class="keyword">program</span> example</div><div class="line">    <span class="keywordtype">use </span>iso_fortran_env</div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespacefplot__core.html">fplot_core</a></div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespacesignals.html">signals</a></div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespaceconstants.html">constants</a></div><div class="line">    <span class="keywordtype">implicit none</span></div><div class="line"></div><div class="line">    <span class="comment">! Parameters</span></div><div class="line">    <span class="keywordtype">integer(int32)</span>, <span class="keywordtype">parameter</span> :: n = 2048</div><div class="line">    <span class="keywordtype">real(real64)</span>, <span class="keywordtype">parameter</span> :: a = 0.0d0</div><div class="line">    <span class="keywordtype">real(real64)</span>, <span class="keywordtype">parameter</span> :: b = 4.0d0 * pi</div><div class="line"></div><div class="line">    <span class="comment">! Local Variables</span></div><div class="line">    <span class="keywordtype">integer(int32)</span> :: i</div><div class="line">    <span class="keywordtype">real(real64)</span> :: x(n), y(n), dydx(n), ans(n), d2ydx2(n), dx</div><div class="line">    <span class="keywordtype">type</span>(plot_2d) :: plt</div><div class="line">    <span class="keywordtype">type</span>(plot_data_2d) :: d1, d2, d3</div><div class="line">    <span class="keywordtype">class</span>(legend), <span class="keywordtype">pointer</span> :: lgnd</div><div class="line"></div><div class="line">    <span class="comment">! Initialization</span></div><div class="line">    dx = (b - a) / n</div><div class="line">    <span class="keywordflow">do</span> i = 1, n</div><div class="line">        x(i) = a + dx * (i - 1.0d0)</div><div class="line"><span class="keywordflow">    end do</span></div><div class="line">    y = sin(x)</div><div class="line">    ans = cos(x)</div><div class="line">    <span class="keyword">call </span>plt%initialize()</div><div class="line">    <span class="keyword">call </span>plt%set_font_size(14)</div><div class="line"></div><div class="line">    lgnd =&gt; plt%get_legend()</div><div class="line">    <span class="keyword">call </span>lgnd%set_is_visible(.true.)</div><div class="line">    <span class="keyword">call </span>lgnd%set_draw_inside_axes(.false.)</div><div class="line">    <span class="keyword">call </span>lgnd%set_horizontal_position(legend_center)</div><div class="line">    <span class="keyword">call </span>lgnd%set_vertical_position(legend_bottom)</div><div class="line">    <span class="keyword">call </span>lgnd%set_draw_border(.false.)</div><div class="line"></div><div class="line">    <span class="comment">! Compute the derivatives</span></div><div class="line">    dydx = <a class="code" href="interfacesignals_1_1fourier__diff.html">fourier_diff</a>(x, y)</div><div class="line">    d2ydx2 = <a class="code" href="interfacesignals_1_1fourier__diff2.html">fourier_diff2</a>(x, y)</div><div class="line"></div><div class="line">    <span class="comment">! Plot the results</span></div><div class="line">    <span class="keyword">call </span>d1%set_name(<span class="stringliteral">&quot;Fourier&quot;</span>)</div><div class="line">    <span class="keyword">call </span>d1%set_line_width(2.0)</div><div class="line">    <span class="keyword">call </span>d1%define_data(x, dydx)</div><div class="line"></div><div class="line">    <span class="keyword">call </span>d2%set_name(<span class="stringliteral">&quot;Analytic&quot;</span>)</div><div class="line">    <span class="keyword">call </span>d2%set_line_style(line_dashed)</div><div class="line">    <span class="keyword">call </span>d2%set_line_width(3.0)</div><div class="line">    <span class="keyword">call </span>d2%set_line_color(clr_red)</div><div class="line">    <span class="keyword">call </span>d2%define_data(x, ans)</div><div class="line"></div><div class="line">    <span class="keyword">call </span>d3%set_name(<span class="stringliteral">&quot;2nd Derivative&quot;</span>)</div><div class="line">    <span class="keyword">call </span>d3%set_line_style(line_dash_dotted)</div><div class="line">    <span class="keyword">call </span>d3%set_line_width(2.0)</div><div class="line">    <span class="keyword">call </span>d3%set_line_color(clr_green)</div><div class="line">    <span class="keyword">call </span>d3%define_data(x, d2ydx2)</div><div class="line"></div><div class="line">    <span class="keyword">call </span>plt%push(d1)</div><div class="line">    <span class="keyword">call </span>plt%push(d2)</div><div class="line">    <span class="keyword">call </span>plt%push(d3)</div><div class="line">    <span class="keyword">call </span>plt%draw()</div><div class="line"><span class="keyword">end program</span></div></div><!-- fragment --> The above program produces the following output. <div class="image">
<img src="fourier_diff_example.png" alt="fourier_diff_example.png"/>
<div class="caption">
Computes the derivative of a data set by utilizing its Fourier</div></div>
 transform. Notice, this routine does expect the signal is periodic at it's boundaries. For nonperiodic signals this routine will give erroneous results. Additionally, it is assumed that the data is sampled over equal intervals.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dx</td><td>The sample interval. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>An N-element array containing the signal. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An N-element array containing the derivative of <code>y</code> with respect to the independent variable bounded by <code>a</code> and <code>b</code>.</dd></dl>
<dl class="section user"><dt>Example</dt><dd>The following example illustrates how to compute the first and second derivatives of a periodic signal. <div class="fragment"><div class="line"><span class="keyword">program</span> example</div><div class="line">    <span class="keywordtype">use </span>iso_fortran_env</div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespacefplot__core.html">fplot_core</a></div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespacesignals.html">signals</a></div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespaceconstants.html">constants</a></div><div class="line">    <span class="keywordtype">implicit none</span></div><div class="line"></div><div class="line">    <span class="comment">! Parameters</span></div><div class="line">    <span class="keywordtype">integer(int32)</span>, <span class="keywordtype">parameter</span> :: n = 2048</div><div class="line">    <span class="keywordtype">real(real64)</span>, <span class="keywordtype">parameter</span> :: a = 0.0d0</div><div class="line">    <span class="keywordtype">real(real64)</span>, <span class="keywordtype">parameter</span> :: b = 4.0d0 * pi</div><div class="line"></div><div class="line">    <span class="comment">! Local Variables</span></div><div class="line">    <span class="keywordtype">integer(int32)</span> :: i</div><div class="line">    <span class="keywordtype">real(real64)</span> :: x(n), y(n), dydx(n), ans(n), d2ydx2(n), dx</div><div class="line">    <span class="keywordtype">type</span>(plot_2d) :: plt</div><div class="line">    <span class="keywordtype">type</span>(plot_data_2d) :: d1, d2, d3</div><div class="line">    <span class="keywordtype">class</span>(legend), <span class="keywordtype">pointer</span> :: lgnd</div><div class="line"></div><div class="line">    <span class="comment">! Initialization</span></div><div class="line">    dx = (b - a) / n</div><div class="line">    <span class="keywordflow">do</span> i = 1, n</div><div class="line">        x(i) = a + dx * (i - 1.0d0)</div><div class="line"><span class="keywordflow">    end do</span></div><div class="line">    y = sin(x)</div><div class="line">    ans = cos(x)</div><div class="line">    <span class="keyword">call </span>plt%initialize()</div><div class="line">    <span class="keyword">call </span>plt%set_font_size(14)</div><div class="line"></div><div class="line">    lgnd =&gt; plt%get_legend()</div><div class="line">    <span class="keyword">call </span>lgnd%set_is_visible(.true.)</div><div class="line">    <span class="keyword">call </span>lgnd%set_draw_inside_axes(.false.)</div><div class="line">    <span class="keyword">call </span>lgnd%set_horizontal_position(legend_center)</div><div class="line">    <span class="keyword">call </span>lgnd%set_vertical_position(legend_bottom)</div><div class="line">    <span class="keyword">call </span>lgnd%set_draw_border(.false.)</div><div class="line"></div><div class="line">    <span class="comment">! Compute the derivatives</span></div><div class="line">    dydx = <a class="code" href="interfacesignals_1_1fourier__diff.html">fourier_diff</a>(dx, y)</div><div class="line">    d2ydx2 = <a class="code" href="interfacesignals_1_1fourier__diff2.html">fourier_diff2</a>(dx, y)</div><div class="line"></div><div class="line">    <span class="comment">! Plot the results</span></div><div class="line">    <span class="keyword">call </span>d1%set_name(<span class="stringliteral">&quot;Fourier&quot;</span>)</div><div class="line">    <span class="keyword">call </span>d1%set_line_width(2.0)</div><div class="line">    <span class="keyword">call </span>d1%define_data(x, dydx)</div><div class="line"></div><div class="line">    <span class="keyword">call </span>d2%set_name(<span class="stringliteral">&quot;Analytic&quot;</span>)</div><div class="line">    <span class="keyword">call </span>d2%set_line_style(line_dashed)</div><div class="line">    <span class="keyword">call </span>d2%set_line_width(3.0)</div><div class="line">    <span class="keyword">call </span>d2%set_line_color(clr_red)</div><div class="line">    <span class="keyword">call </span>d2%define_data(x, ans)</div><div class="line"></div><div class="line">    <span class="keyword">call </span>d3%set_name(<span class="stringliteral">&quot;2nd Derivative&quot;</span>)</div><div class="line">    <span class="keyword">call </span>d3%set_line_style(line_dash_dotted)</div><div class="line">    <span class="keyword">call </span>d3%set_line_width(2.0)</div><div class="line">    <span class="keyword">call </span>d3%set_line_color(clr_green)</div><div class="line">    <span class="keyword">call </span>d3%define_data(x, d2ydx2)</div><div class="line"></div><div class="line">    <span class="keyword">call </span>plt%push(d1)</div><div class="line">    <span class="keyword">call </span>plt%push(d2)</div><div class="line">    <span class="keyword">call </span>plt%push(d3)</div><div class="line">    <span class="keyword">call </span>plt%draw()</div><div class="line"><span class="keyword">end program</span></div></div><!-- fragment --> The above program produces the following output. <div class="image">
<img src="fourier_diff_example.png" alt="fourier_diff_example.png"/>
<div class="caption">
Computes the second derivative of a data set by utilizing its </div></div>
 Fourier transform. Notice, this routine does expect the signal is periodic at it's boundaries. For nonperiodic signals this routine will give erroneous results. Additionally, it is assumed that the data is sampled over equal intervals.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>The lower limit of the sample region. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>The upper limit of the sample region. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>An N-element array containing the signal. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An N-element array containing the second derivative of <code>y</code> with respect to the independent variable bounded by <code>a</code> and <code>b</code>.</dd></dl>
<dl class="section user"><dt>Example</dt><dd>The following example illustrates how to compute the first and second derivatives of a periodic signal. <div class="fragment"><div class="line"><span class="keyword">program</span> example</div><div class="line">    <span class="keywordtype">use </span>iso_fortran_env</div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespacefplot__core.html">fplot_core</a></div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespacesignals.html">signals</a></div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespaceconstants.html">constants</a></div><div class="line">    <span class="keywordtype">implicit none</span></div><div class="line"></div><div class="line">    <span class="comment">! Parameters</span></div><div class="line">    <span class="keywordtype">integer(int32)</span>, <span class="keywordtype">parameter</span> :: n = 2048</div><div class="line">    <span class="keywordtype">real(real64)</span>, <span class="keywordtype">parameter</span> :: a = 0.0d0</div><div class="line">    <span class="keywordtype">real(real64)</span>, <span class="keywordtype">parameter</span> :: b = 4.0d0 * pi</div><div class="line"></div><div class="line">    <span class="comment">! Local Variables</span></div><div class="line">    <span class="keywordtype">integer(int32)</span> :: i</div><div class="line">    <span class="keywordtype">real(real64)</span> :: x(n), y(n), dydx(n), ans(n), d2ydx2(n), dx</div><div class="line">    <span class="keywordtype">type</span>(plot_2d) :: plt</div><div class="line">    <span class="keywordtype">type</span>(plot_data_2d) :: d1, d2, d3</div><div class="line">    <span class="keywordtype">class</span>(legend), <span class="keywordtype">pointer</span> :: lgnd</div><div class="line"></div><div class="line">    <span class="comment">! Initialization</span></div><div class="line">    dx = (b - a) / n</div><div class="line">    <span class="keywordflow">do</span> i = 1, n</div><div class="line">        x(i) = a + dx * (i - 1.0d0)</div><div class="line"><span class="keywordflow">    end do</span></div><div class="line">    y = sin(x)</div><div class="line">    ans = cos(x)</div><div class="line">    <span class="keyword">call </span>plt%initialize()</div><div class="line">    <span class="keyword">call </span>plt%set_font_size(14)</div><div class="line"></div><div class="line">    lgnd =&gt; plt%get_legend()</div><div class="line">    <span class="keyword">call </span>lgnd%set_is_visible(.true.)</div><div class="line">    <span class="keyword">call </span>lgnd%set_draw_inside_axes(.false.)</div><div class="line">    <span class="keyword">call </span>lgnd%set_horizontal_position(legend_center)</div><div class="line">    <span class="keyword">call </span>lgnd%set_vertical_position(legend_bottom)</div><div class="line">    <span class="keyword">call </span>lgnd%set_draw_border(.false.)</div><div class="line"></div><div class="line">    <span class="comment">! Compute the derivatives</span></div><div class="line">    dydx = <a class="code" href="interfacesignals_1_1fourier__diff.html">fourier_diff</a>(a, b, y)</div><div class="line">    d2ydx2 = <a class="code" href="interfacesignals_1_1fourier__diff2.html">fourier_diff2</a>(a, b, y)</div><div class="line"></div><div class="line">    <span class="comment">! Plot the results</span></div><div class="line">    <span class="keyword">call </span>d1%set_name(<span class="stringliteral">&quot;Fourier&quot;</span>)</div><div class="line">    <span class="keyword">call </span>d1%set_line_width(2.0)</div><div class="line">    <span class="keyword">call </span>d1%define_data(x, dydx)</div><div class="line"></div><div class="line">    <span class="keyword">call </span>d2%set_name(<span class="stringliteral">&quot;Analytic&quot;</span>)</div><div class="line">    <span class="keyword">call </span>d2%set_line_style(line_dashed)</div><div class="line">    <span class="keyword">call </span>d2%set_line_width(3.0)</div><div class="line">    <span class="keyword">call </span>d2%set_line_color(clr_red)</div><div class="line">    <span class="keyword">call </span>d2%define_data(x, ans)</div><div class="line"></div><div class="line">    <span class="keyword">call </span>d3%set_name(<span class="stringliteral">&quot;2nd Derivative&quot;</span>)</div><div class="line">    <span class="keyword">call </span>d3%set_line_style(line_dash_dotted)</div><div class="line">    <span class="keyword">call </span>d3%set_line_width(2.0)</div><div class="line">    <span class="keyword">call </span>d3%set_line_color(clr_green)</div><div class="line">    <span class="keyword">call </span>d3%define_data(x, d2ydx2)</div><div class="line"></div><div class="line">    <span class="keyword">call </span>plt%push(d1)</div><div class="line">    <span class="keyword">call </span>plt%push(d2)</div><div class="line">    <span class="keyword">call </span>plt%push(d3)</div><div class="line">    <span class="keyword">call </span>plt%draw()</div><div class="line"><span class="keyword">end program</span></div></div><!-- fragment --> The above program produces the following output. <div class="image">
<img src="fourier_diff_example.png" alt="fourier_diff_example.png"/>
<div class="caption">
Computes the second derivative of a data set by utilizing its </div></div>
 Fourier transform. Notice, this routine does expect the signal is periodic at it's boundaries. For nonperiodic signals this routine will give erroneous results. Additionally, it is assumed that the data is sampled over equal intervals.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>An N-element array containing the values of the independent variable at which the signal was sampled. It is assumed that the signal is sampled at equal increments. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>An N-element array containing the signal. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An N-element array containing the second derivative of <code>y</code> with respect to the independent variable bounded by <code>a</code> and <code>b</code>.</dd></dl>
<dl class="section user"><dt>Example</dt><dd>The following example illustrates how to compute the first and second derivatives of a periodic signal. <div class="fragment"><div class="line"><span class="keyword">program</span> example</div><div class="line">    <span class="keywordtype">use </span>iso_fortran_env</div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespacefplot__core.html">fplot_core</a></div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespacesignals.html">signals</a></div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespaceconstants.html">constants</a></div><div class="line">    <span class="keywordtype">implicit none</span></div><div class="line"></div><div class="line">    <span class="comment">! Parameters</span></div><div class="line">    <span class="keywordtype">integer(int32)</span>, <span class="keywordtype">parameter</span> :: n = 2048</div><div class="line">    <span class="keywordtype">real(real64)</span>, <span class="keywordtype">parameter</span> :: a = 0.0d0</div><div class="line">    <span class="keywordtype">real(real64)</span>, <span class="keywordtype">parameter</span> :: b = 4.0d0 * pi</div><div class="line"></div><div class="line">    <span class="comment">! Local Variables</span></div><div class="line">    <span class="keywordtype">integer(int32)</span> :: i</div><div class="line">    <span class="keywordtype">real(real64)</span> :: x(n), y(n), dydx(n), ans(n), d2ydx2(n), dx</div><div class="line">    <span class="keywordtype">type</span>(plot_2d) :: plt</div><div class="line">    <span class="keywordtype">type</span>(plot_data_2d) :: d1, d2, d3</div><div class="line">    <span class="keywordtype">class</span>(legend), <span class="keywordtype">pointer</span> :: lgnd</div><div class="line"></div><div class="line">    <span class="comment">! Initialization</span></div><div class="line">    dx = (b - a) / n</div><div class="line">    <span class="keywordflow">do</span> i = 1, n</div><div class="line">        x(i) = a + dx * (i - 1.0d0)</div><div class="line"><span class="keywordflow">    end do</span></div><div class="line">    y = sin(x)</div><div class="line">    ans = cos(x)</div><div class="line">    <span class="keyword">call </span>plt%initialize()</div><div class="line">    <span class="keyword">call </span>plt%set_font_size(14)</div><div class="line"></div><div class="line">    lgnd =&gt; plt%get_legend()</div><div class="line">    <span class="keyword">call </span>lgnd%set_is_visible(.true.)</div><div class="line">    <span class="keyword">call </span>lgnd%set_draw_inside_axes(.false.)</div><div class="line">    <span class="keyword">call </span>lgnd%set_horizontal_position(legend_center)</div><div class="line">    <span class="keyword">call </span>lgnd%set_vertical_position(legend_bottom)</div><div class="line">    <span class="keyword">call </span>lgnd%set_draw_border(.false.)</div><div class="line"></div><div class="line">    <span class="comment">! Compute the derivatives</span></div><div class="line">    dydx = <a class="code" href="interfacesignals_1_1fourier__diff.html">fourier_diff</a>(x, y)</div><div class="line">    d2ydx2 = <a class="code" href="interfacesignals_1_1fourier__diff2.html">fourier_diff2</a>(x, y)</div><div class="line"></div><div class="line">    <span class="comment">! Plot the results</span></div><div class="line">    <span class="keyword">call </span>d1%set_name(<span class="stringliteral">&quot;Fourier&quot;</span>)</div><div class="line">    <span class="keyword">call </span>d1%set_line_width(2.0)</div><div class="line">    <span class="keyword">call </span>d1%define_data(x, dydx)</div><div class="line"></div><div class="line">    <span class="keyword">call </span>d2%set_name(<span class="stringliteral">&quot;Analytic&quot;</span>)</div><div class="line">    <span class="keyword">call </span>d2%set_line_style(line_dashed)</div><div class="line">    <span class="keyword">call </span>d2%set_line_width(3.0)</div><div class="line">    <span class="keyword">call </span>d2%set_line_color(clr_red)</div><div class="line">    <span class="keyword">call </span>d2%define_data(x, ans)</div><div class="line"></div><div class="line">    <span class="keyword">call </span>d3%set_name(<span class="stringliteral">&quot;2nd Derivative&quot;</span>)</div><div class="line">    <span class="keyword">call </span>d3%set_line_style(line_dash_dotted)</div><div class="line">    <span class="keyword">call </span>d3%set_line_width(2.0)</div><div class="line">    <span class="keyword">call </span>d3%set_line_color(clr_green)</div><div class="line">    <span class="keyword">call </span>d3%define_data(x, d2ydx2)</div><div class="line"></div><div class="line">    <span class="keyword">call </span>plt%push(d1)</div><div class="line">    <span class="keyword">call </span>plt%push(d2)</div><div class="line">    <span class="keyword">call </span>plt%push(d3)</div><div class="line">    <span class="keyword">call </span>plt%draw()</div><div class="line"><span class="keyword">end program</span></div></div><!-- fragment --> The above program produces the following output. <div class="image">
<img src="fourier_diff_example.png" alt="fourier_diff_example.png"/>
<div class="caption">
Computes the second derivative of a data set by utilizing its </div></div>
 Fourier transform. Notice, this routine does expect the signal is periodic at it's boundaries. For nonperiodic signals this routine will give erroneous results. Additionally, it is assumed that the data is sampled over equal intervals.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dx</td><td>The sample interval. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>An N-element array containing the signal. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An N-element array containing the second derivative of <code>y</code> with respect to the independent variable bounded by <code>a</code> and <code>b</code>.</dd></dl>
<dl class="section user"><dt>Example</dt><dd>The following example illustrates how to compute the first and second derivatives of a periodic signal. <div class="fragment"><div class="line"><span class="keyword">program</span> example</div><div class="line">    <span class="keywordtype">use </span>iso_fortran_env</div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespacefplot__core.html">fplot_core</a></div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespacesignals.html">signals</a></div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespaceconstants.html">constants</a></div><div class="line">    <span class="keywordtype">implicit none</span></div><div class="line"></div><div class="line">    <span class="comment">! Parameters</span></div><div class="line">    <span class="keywordtype">integer(int32)</span>, <span class="keywordtype">parameter</span> :: n = 2048</div><div class="line">    <span class="keywordtype">real(real64)</span>, <span class="keywordtype">parameter</span> :: a = 0.0d0</div><div class="line">    <span class="keywordtype">real(real64)</span>, <span class="keywordtype">parameter</span> :: b = 4.0d0 * pi</div><div class="line"></div><div class="line">    <span class="comment">! Local Variables</span></div><div class="line">    <span class="keywordtype">integer(int32)</span> :: i</div><div class="line">    <span class="keywordtype">real(real64)</span> :: x(n), y(n), dydx(n), ans(n), d2ydx2(n), dx</div><div class="line">    <span class="keywordtype">type</span>(plot_2d) :: plt</div><div class="line">    <span class="keywordtype">type</span>(plot_data_2d) :: d1, d2, d3</div><div class="line">    <span class="keywordtype">class</span>(legend), <span class="keywordtype">pointer</span> :: lgnd</div><div class="line"></div><div class="line">    <span class="comment">! Initialization</span></div><div class="line">    dx = (b - a) / n</div><div class="line">    <span class="keywordflow">do</span> i = 1, n</div><div class="line">        x(i) = a + dx * (i - 1.0d0)</div><div class="line"><span class="keywordflow">    end do</span></div><div class="line">    y = sin(x)</div><div class="line">    ans = cos(x)</div><div class="line">    <span class="keyword">call </span>plt%initialize()</div><div class="line">    <span class="keyword">call </span>plt%set_font_size(14)</div><div class="line"></div><div class="line">    lgnd =&gt; plt%get_legend()</div><div class="line">    <span class="keyword">call </span>lgnd%set_is_visible(.true.)</div><div class="line">    <span class="keyword">call </span>lgnd%set_draw_inside_axes(.false.)</div><div class="line">    <span class="keyword">call </span>lgnd%set_horizontal_position(legend_center)</div><div class="line">    <span class="keyword">call </span>lgnd%set_vertical_position(legend_bottom)</div><div class="line">    <span class="keyword">call </span>lgnd%set_draw_border(.false.)</div><div class="line"></div><div class="line">    <span class="comment">! Compute the derivatives</span></div><div class="line">    dydx = <a class="code" href="interfacesignals_1_1fourier__diff.html">fourier_diff</a>(dx, y)</div><div class="line">    d2ydx2 = <a class="code" href="interfacesignals_1_1fourier__diff2.html">fourier_diff2</a>(dx, y)</div><div class="line"></div><div class="line">    <span class="comment">! Plot the results</span></div><div class="line">    <span class="keyword">call </span>d1%set_name(<span class="stringliteral">&quot;Fourier&quot;</span>)</div><div class="line">    <span class="keyword">call </span>d1%set_line_width(2.0)</div><div class="line">    <span class="keyword">call </span>d1%define_data(x, dydx)</div><div class="line"></div><div class="line">    <span class="keyword">call </span>d2%set_name(<span class="stringliteral">&quot;Analytic&quot;</span>)</div><div class="line">    <span class="keyword">call </span>d2%set_line_style(line_dashed)</div><div class="line">    <span class="keyword">call </span>d2%set_line_width(3.0)</div><div class="line">    <span class="keyword">call </span>d2%set_line_color(clr_red)</div><div class="line">    <span class="keyword">call </span>d2%define_data(x, ans)</div><div class="line"></div><div class="line">    <span class="keyword">call </span>d3%set_name(<span class="stringliteral">&quot;2nd Derivative&quot;</span>)</div><div class="line">    <span class="keyword">call </span>d3%set_line_style(line_dash_dotted)</div><div class="line">    <span class="keyword">call </span>d3%set_line_width(2.0)</div><div class="line">    <span class="keyword">call </span>d3%set_line_color(clr_green)</div><div class="line">    <span class="keyword">call </span>d3%define_data(x, d2ydx2)</div><div class="line"></div><div class="line">    <span class="keyword">call </span>plt%push(d1)</div><div class="line">    <span class="keyword">call </span>plt%push(d2)</div><div class="line">    <span class="keyword">call </span>plt%push(d3)</div><div class="line">    <span class="keyword">call </span>plt%draw()</div><div class="line"><span class="keyword">end program</span></div></div><!-- fragment --> The above program produces the following output. <div class="image">
<img src="fourier_diff_example.png" alt="fourier_diff_example.png"/>
<div class="caption">
Computes the derivative of a signal via finite differences. A</div></div>
 forward difference is used to step into the problem, a central difference is used through the middle section, and a backward difference is used to step out of the problem. Notice, this technique is highly susceptable to noise in the signal.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>An N-element array containing the values of the independent variable at which the signal was sampled. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>An N-element array containing the signal. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An N-element array containing the derivative. Computes the derivative of a signal via finite differences. A forward difference is used to step into the problem, a central difference is used through the middle section, and a backward difference is used to step out of the problem. Notice, this technique is highly susceptable to noise in the signal.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dx</td><td>The sample interval. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>An N-element array containing the signal. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An N-element array containing the derivative. Computes the antiderivative of a signal via Euler's method.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>An N-element array containing the values of the independent variable at which the signal was sampled. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>An N-element array containing the signal. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>An optional argument used to specify the initial condition. If no value is given, a value of zero is used. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An N-element array containing the antiderivative of the signal. Computes the antiderivative of a signal via Euler's method.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dx</td><td>The sample interval. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>An N-element array containing the signal. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>An optional argument used to specify the initial condition. If no value is given, a value of zero is used. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An N-element array containing the antiderivative of the signal. Computes the integral of a signal via trapezoidal integration.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>An N-element array containing the values of the independent variable at which the signal was sampled. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>An N-element array containing the signal. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The value of the integral. Computes the integral of a signal via trapezoidal integration.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dx</td><td>The sample interval. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>An N-element array containing the signal. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The value of the integral. Defines a real-time digital filter. </dd></dl>

<p class="definition">Definition at line <a class="el" href="signals_8f90_source.html#l01499">1499</a> of file <a class="el" href="signals_8f90_source.html">signals.f90</a>.</p>
</div><hr/>The documentation for this type was generated from the following file:<ul>
<li>C:/Users/jchri/Documents/github/mecheng/src/signals/<a class="el" href="signals_8f90_source.html">signals.f90</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacesignals.html">signals</a></li><li class="navelem"><a class="el" href="structsignals_1_1realtime__filter.html">realtime_filter</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
